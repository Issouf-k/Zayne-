const a44_0x274c97=a44_0xf363;function a44_0xf363(_0x1625d2,_0x12d19e){const _0x23a30e=a44_0x23a3();return a44_0xf363=function(_0xf36396,_0x4294e2){_0xf36396=_0xf36396-0x94;let _0x5ecc13=_0x23a30e[_0xf36396];return _0x5ecc13;},a44_0xf363(_0x1625d2,_0x12d19e);}(function(_0x143dc6,_0x45f98e){const _0xfdb2c6=a44_0xf363,_0x13acd6=_0x143dc6();while(!![]){try{const _0x28808a=-parseInt(_0xfdb2c6(0xac))/0x1+parseInt(_0xfdb2c6(0xbf))/0x2+-parseInt(_0xfdb2c6(0x9f))/0x3*(parseInt(_0xfdb2c6(0xa5))/0x4)+-parseInt(_0xfdb2c6(0xb6))/0x5+-parseInt(_0xfdb2c6(0xb1))/0x6+-parseInt(_0xfdb2c6(0x9a))/0x7+-parseInt(_0xfdb2c6(0xbd))/0x8*(-parseInt(_0xfdb2c6(0xb9))/0x9);if(_0x28808a===_0x45f98e)break;else _0x13acd6['push'](_0x13acd6['shift']());}catch(_0x95f9e2){_0x13acd6['push'](_0x13acd6['shift']());}}}(a44_0x23a3,0xdae47));import{Sticker,StickerTypes}from'wa-sticker-formatter';import a44_0xa052f2 from'sharp';import a44_0x5b92ed from'../utils/download_media.js';import{listerPremierFichierTemporaire}from'../utils/vu_unique.js';import{join}from'path';import a44_0x4de70a from'fs/promises';import a44_0x33829f from'dotenv';import{send_reaction_message,send_text_message}from'../utils/sendmessagewa.js';a44_0x33829f[a44_0x274c97(0x94)]();const MEDIA_PATH=process[a44_0x274c97(0xc1)][a44_0x274c97(0xba)];async function validateWebP(_0xa6a2d5){const _0xbb9964=a44_0x274c97;try{if(!_0xa6a2d5||_0xa6a2d5[_0xbb9964(0x97)]<0xc)return![];const _0x5fc9ae=_0xa6a2d5[_0xbb9964(0x95)](0x0,0x4)['toString'](_0xbb9964(0x99))===_0xbb9964(0xb4),_0x2155ea=_0xa6a2d5[_0xbb9964(0x95)](0x8,0xc)[_0xbb9964(0xb5)]('hex')===_0xbb9964(0xa2);return _0x5fc9ae&&_0x2155ea;}catch(_0x544a79){return console[_0xbb9964(0xc0)](_0xbb9964(0x9c),_0x544a79),![];}}async function createSticker(_0x5d5da2,_0x2c714a,_0x261656){const _0x1621fb=a44_0x274c97;try{const _0x355dcf=new Sticker(_0x5d5da2,{'pack':_0x2c714a||'VansBot','author':_0x261656||_0x1621fb(0xbe),'type':StickerTypes['FULL'],'quality':0x46,'categories':[_0x1621fb(0xa7),_0x1621fb(0xaa)]});return await _0x355dcf[_0x1621fb(0xbc)]();}catch(_0x525637){console[_0x1621fb(0xc0)]('Erreur\x20lors\x20de\x20la\x20cr√©ation\x20du\x20sticker:',_0x525637);throw new Error(_0x1621fb(0xa0)+_0x525637[_0x1621fb(0xa3)]);}}export async function modifyLocalSticker(_0x349222,_0x556f57,_0x235c2a){const _0x4fc033=a44_0x274c97;try{const _0x1594bf=await a44_0x4de70a['readFile'](_0x349222);if(!await validateWebP(_0x1594bf)){console[_0x4fc033(0x9d)](_0x4fc033(0xb2));const _0x58d52e=await a44_0xa052f2(_0x1594bf)[_0x4fc033(0x9e)]('webp')[_0x4fc033(0xbc)]();if(!await validateWebP(_0x58d52e))throw new Error(_0x4fc033(0xb7));return await createSticker(_0x58d52e,_0x556f57,_0x235c2a);}return await createSticker(_0x1594bf,_0x556f57,_0x235c2a);}catch(_0x1c2f8b){console[_0x4fc033(0xc0)](_0x4fc033(0xa6),_0x1c2f8b);throw new Error(_0x4fc033(0x96)+_0x1c2f8b[_0x4fc033(0xa3)]);}}export async function handleTakeSticker(_0x283c34,_0x142154,_0x19396a,_0x90ca1f,_0xee2a1b){const _0x40af01=a44_0x274c97;let _0x27fc36=null;_0xee2a1b=_0x40af01(0xb0),_0x90ca1f=_0x142154['pushName']||'Utilisateur';try{if(!_0x142154?.[_0x40af01(0xa3)]?.[_0x40af01(0xbb)]?.[_0x40af01(0xa8)])throw new Error(_0x40af01(0xa1));const _0x18c707=_0x142154[_0x40af01(0xa3)][_0x40af01(0xbb)]['contextInfo'];if(!_0x18c707[_0x40af01(0x98)])throw new Error(_0x40af01(0xae));const _0x3b6f53={'key':{'remoteJid':_0x142154['key']['remoteJid'],'id':_0x18c707[_0x40af01(0x9b)],'fromMe':![]},'message':_0x18c707[_0x40af01(0x98)]};await send_reaction_message(_0x283c34,_0x142154,_0x19396a,'‚öô');const _0x268338=await a44_0x5b92ed(_0x283c34,_0x3b6f53,_0x40af01(0xab));if(!_0x268338)throw new Error('√âchec\x20du\x20t√©l√©chargement\x20du\x20m√©dia');const _0x383070=await listerPremierFichierTemporaire(MEDIA_PATH,'takesticker');if(!_0x383070)throw new Error('Aucun\x20m√©dia\x20trouv√©\x20apr√®s\x20t√©l√©chargement');_0x27fc36=join(MEDIA_PATH,_0x383070['chemin']);try{await a44_0x4de70a[_0x40af01(0xb3)](_0x27fc36);}catch{throw new Error(_0x40af01(0xa4));}const _0x1fca66=await modifyLocalSticker(_0x27fc36,_0x90ca1f,_0xee2a1b);await _0x283c34[_0x40af01(0xb8)](_0x19396a,{'sticker':_0x1fca66}),await send_reaction_message(_0x283c34,_0x142154,_0x19396a,'‚úÖ');}catch(_0x1db529){console[_0x40af01(0xc0)]('Erreur\x20dans\x20handleTakeSticker:',_0x1db529),await send_text_message(_0x283c34,_0x142154,_0x40af01(0xa9)+_0x1db529[_0x40af01(0xa3)],_0x19396a,[],!![],![],!![]);}finally{if(_0x27fc36)try{await a44_0x4de70a[_0x40af01(0xaf)](_0x27fc36);}catch(_0x580661){console[_0x40af01(0xad)]('Nettoyage\x20du\x20fichier\x20temporaire\x20√©chou√©:',_0x580661);}}}function a44_0x23a3(){const _0x36891b=['72174VISSPt','√âchec\x20de\x20la\x20cr√©ation\x20du\x20sticker:\x20','R√©pondez\x20√†\x20un\x20message\x20contenant\x20un\x20sticker','57454250','message','Le\x20fichier\x20t√©l√©charg√©\x20est\x20introuvable','88KHeovo','Erreur\x20lors\x20de\x20la\x20modification\x20du\x20sticker:','FUN','contextInfo','>\x20‚ùå\x20Erreur:\x20','VANSBOT','takesticker','1688095lEoxtc','warn','Le\x20message\x20cit√©\x20est\x20introuvable','unlink','\x0a\x20ùëΩùë®ùëµùë∫ùë©ùë∂ùëª\x20À£·¥π·¥∞\x20·¥∫·¥±·µÇ\x20·¥≥·¥±·¥∫·¥±·¥ø·¥¨·µÄ·¥µ·¥º·¥∫','5233386cwnRwm','Le\x20fichier\x20n\x27est\x20pas\x20un\x20WebP\x20valide,\x20tentative\x20de\x20conversion...','access','52494646','toString','5039255jksVmN','Le\x20fichier\x20n\x27est\x20pas\x20un\x20WebP\x20valide\x20et\x20n\x27a\x20pas\x20pu\x20√™tre\x20converti','sendMessage','19269981qdUfkm','MEDIA_PATH','extendedTextMessage','toBuffer','24SDGjlT','vanscode','412304eELNmu','error','env','config','slice','√âchec\x20de\x20la\x20modification\x20du\x20sticker:\x20','length','quotedMessage','hex','11448101zUDWAV','stanzaId','Erreur\x20lors\x20de\x20la\x20validation\x20WebP:','log','toFormat'];a44_0x23a3=function(){return _0x36891b;};return a44_0x23a3();}